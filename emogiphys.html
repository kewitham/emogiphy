<html>
<head>
	<title>Giphy Feels</title>
	<link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
	<link rel="stylesheet" href="style.css">
</head>
<body>

<div class="container">
<div class="page-header">
  <h1>All the Feels <small>Click on one of the buttons to see the emotion in giphys or enter your own emotion below.</small></h1>
</div>

  <div id="buttonsView"></div>

  <form id="emo-form">
    <label for="emo-input">Enter an emotion here:</label>
    <input type="text" id="emo-input"><br>
    
    <input id="addEmo" type="submit" value="submit your emotion">
  </form>


<div id="emoView"></div>
<div id="emoDiv"></div>

<script src='http://code.jquery.com/jquery-2.1.3.min.js'></script>
<script type="text/javascript">

	var emos = ['sad', 'happy', 'awkward', 'drunk'];

	function displayEmoGiphys(button, i){ 

		var emote = $(button).attr('data-name');
		var queryURL = "http://api.giphy.com/v1/gifs/search?q=" + emote + "&api_key=dc6zaTOxFJmzC&limit=9";
		
		$.ajax({url: queryURL, method: 'GET'})

		.done(function(response) {

			var emoDiv = $('<div class="emo">');

			var rating = response.data[i].rating;

			var p_rating = $('<p>').text( "Rating: " + rating);

			emoDiv.append(p_rating);


			var emoImage = $("<img>");
			
			//STORING SOURCE URL'S IN THE EMOIMAGE OBJECT
            emoImage.staticUrl = response.data[i].images.original_still.url; 
			emoImage.animatedUrl = response.data[i].images.original.url;
			emoImage.isAnimated = false;
			
			emoImage.attr('src', emoImage.staticUrl);
			emoImage.attr('alt', 'emo image');
			emoImage.on('click', function(){imageClicked(emoImage);}); 
			
			emoDiv.append(emoImage);

			$('#emoView').prepend(emoImage);
			$('#emoView').prepend(p_rating);
		});

	}

	function displayMultipleEmoGiphys(){
		for (var i=0; i < 9; i++){
			displayEmoGiphys(this, i) 
		}
	}

	function renderButtons(){ 

		$('#buttonsView').empty();

		
		for (var i = 0; i < emos.length; i++){

		    var a = $('<button>') 
		    a.addClass('emote'); 
		    a.attr('data-name', emos[i]); 
		    a.text(emos[i]); 
		    $('#buttonsView').append(a); 
		}
	}

	 

	$('#addEmo').on('click', function(){

		var emote = $('#emo-input').val().trim();

		emos.push(emote);
		
		renderButtons();

		return false;
	});

	
	$(document).on('click', '.emote', displayMultipleEmoGiphys);

	renderButtons();



	function imageClicked(image) { 
		if(image.isAnimated) { 
			image.attr('src',image.staticUrl);
			image.isAnimated = false;
		}
		else {
			image.attr('src',image.animatedUrl); 
			image.isAnimated = true;
		}
		
	
	}

</script>


</body>
</html>